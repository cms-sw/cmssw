2009-07-21 Remi Mommsen <Remigius.Mommsen@cern.ch>

	* tag V05-01-02
	* Fix a couple of issues due to obsolete code removal
	* Minor adjustements to doxygen class documentation

2009-07-20 Remi Mommsen <Remigius.Mommsen@cern.ch>

	* tag V05-01-01
	* Fix logic of file-system selection
	* Increase displayed precision of data rate popped from the DQM queue
	* Complete doxygen class documentation
	* Remove obsolete code
	
2009-07-13 Remi Mommsen <Remigius.Mommsen@cern.ch>

	* tag V05-01-00
	* Properly respond to state-machine SOAP commands and move
	  to Failed state if a SOAP message cannot be handled.
	* Change ownership of monitoring info space and handle all info
	  space related stuff in StatisticsReporter instead of using a
	  static monitoring info space in the MonitoredQuantities.
	* Move sentinel alarming to Utils and fix bug revoking an alarm.
	* Display reason for moving to failed state on the SM web pages.
	* Additional column with potential fix for disk writer thread busy
	  percentage.
	* Minor changes to align state machine transitions with state
	  charts.
	* Fix bug such that first consumerID is 1, not 2.
	
2009-07-06 Dennis Shpakov <Denis.Shpakov@cern.ch>

	* tag V05-00-09
	* Protect state-machine entry and exit action to not throw.
	  This should fix the std::bad_cast bug.
	* Introduce configurable time-out for closing error-event files.
	* Improve monitoring of discard messages (display outstanding
	  discards and keep track of discards per EP, not only per RB).

2009-06-29 Remi Mommsen <Remigius.Mommsen@cern.ch>

	* tag V05-00-08
	* Ugly hack to prevent the std::bad_cast bug to cause error
	  messages being sent every millisecond.
	* Remove no-longer needed pre-processor directives to avoid
	  sentinel reporting in the demoSystem. (Sentinel was added
	  to the demoSystem with tag V05-00-04.)

2009-06-29 Dennis Shpakov <Denis.Shpakov@cern.ch>

	* tag V05-00-07
	* Introduce stale window time to measure time an 
	  event sits in the FragmentStore, not counting
	  any previous queueing time.
	* Monitor number of discards, stale events, and skipped discards.
	* Fix bug where state events were checked 99% of the time instead of 1%.
	* Increase stream queue size from 512 to 2048 entries.

2009-06-21 Dennis Shpakov <Denis.Shpakov@cern.ch>

	* tag V05-00-06
	* Assure that the constructor of StorageManager only
	  throws xcept::exceptions.
	* Improve consumer monitoring web page
	* Make sure that all stale file handles are purged
	* Increase DQM event queue size from 2048 to 3072 and
	  ThroughputMonitorCollection history from 150 to 300 entries.
	* Switch to use python configs only in the demoSystem.

2009-06-18 Remi Mommsen <Remigius.Mommsen@cern.ch>

	* tag V05-00-05
	* Added a protection in the Ready entry action when the
	  configuration cannot update the parameters
	* Fixed an iterator overrun in StreamHandler when deleting
	  FileHandlers from the list of open files.
	
2009-06-15 Remi Mommsen <Remigius.Mommsen@cern.ch>

	* tag V05-00-04
	* Fixed to not revoke a disk-space alarm in ResourceMonitorCollection
	  which is not set.
	* Added the Sentinel to the SM process in the demoSystem setup.

2009-06-12 Remi Mommsen <Remigius.Mommsen@cern.ch>

	* tag V05-00-03
	* Explicitly link with sentinelutils.
	
2009-06-10 Dennis Shpakov <Denis.Shpakov@cern.ch>

	* tag V05-00-02
	* Added include of cstdio for sprintf calls
	  in case it is needed for gcc4.4.
	
2009-06-10 Dennis Shpakov <Denis.Shpakov@cern.ch>

	* tag V05-00-01
	* Merge of refactored code from refdev01_scratch_branch
	  to the trunk.

2009-06-10 Dennis Shpakov <Denis.Shpakov@cern.ch>

	* tag V05-00-00
	* Final release candidate on the refdev01_scratch_branch.
	
2009-06-08  Kurt Biery <biery@fnal.gov>

	* tag V04-02-07
	* Script changes from Constantin.

2009-??-??  ?? <??>

	* tag V04-02-06
	* Include file changes from Peter Elmer for gcc4.4.

2009-??-??  ?? <??>

	* tag V04-02-05
	* From Bill Tanenbaum:  changed @trigger_paths parameter from
	  untracked to tracked in ServiceManager.

2009-03-??  Kurt Biery <biery@fnal.gov>

	* tag V04-02-04
	* From David Dagenhard:  Added option that causes the Framework
	  statemachine to behave as if there is one event per input file
	  and go through new input file transitions before each event.
	  The purpose is to allow the output module to close output files
	  at any point. There is a restriction that output modules are allowed
	  to close output files and open new ones only when a new input file
	  is encountered.  This option is available to all streamer sources,
	  but is by default off except for the EventStreamHttpReader source.
	  This code change has no effect when the option turned off.  The
	  overhead introduced by the Framework itself is small, although it
	  will emit signals for the respondToOpenInputFile and
	  respondToCloseInputFile to modules which could potentially use
	  CPU or have other side effects.

2009-01-27  Kurt Biery <biery@fnal.gov>

	* tag V04-02-03
	* Modified the sending of event consumer registration requests
	  to work around the recent change in edm::ParameterSet to only
	  serialize tracked parameters.

2008-12-29  Kurt Biery <biery@fnal.gov>

	* tag V04-02-02
	* Brought forward the additional DQM statistics from Harry.

2008-12-22  Kurt Biery <biery@fnal.gov>

	* tag V04-02-01
	* Fixed the ChangeLog.

2008-12-22  Kurt Biery <biery@fnal.gov>

	* tag V04-02-00
	* Moved the collection of INIT message fragments from the
	  SMFUSender* classes to the FragmentCollector.
	* Improved fragment collection - allowed fragments out of order,
	  checked for duplicate fragments, checked for incomplete events.
	* Modified the DQM archive filenames to better match the format
	  used by the online consumers.
	* Added support for reconfigurations between runs.
	* Brought forward the additional event statistics from Harry.
	* Included the fix for the spurious discard messages sent to the
	  resource broker.
	* Converted the SM to use Python configuration files, and added
	  sample Python configuration files to test subdirectory.

2008-11-21  Kurt Biery <biery@fnal.gov>

	* tag V04-01-01
	* Added a necessary call to the state machine findRcmsStateListener
	  method in StorageManager.cc after the RCMS parameters are added
	  to the application infospace.

2008-11-26  Peter Elmer <Peter.Elmer@cern.ch>

	* tag V04-01-00-01
	* Removed Foundation/SealBase dependence in test area BuildFile.

2008-10-24  Constantin Loizides <loizides@mit.edu>

	* tag V04-01-00
	* Added calculation of adler32 checksums for streamer and
	  index files, and storage of them in the log files.
	* These changes depend on the following related tags:
	  IOPool/Streamer            V05-05-00

2008-10-22  Constantin Loizides <loizides@mit.edu>

	* tag V04-00-02
	* (CL) Fixed loop over logical disks on SM default web page.
	* (KB) Modified the writing of DQM histograms to disk - all
	  top-level folders are now written to the same file (for a
	  given update), and the directory structure was modified to
	  match what is used in DQM archives created by event consumers.

2008-10-14  Kurt Biery <biery@fnal.gov>

	* tag V04-00-01
	* Added protection to the actionPerformed() method to prevent
	  uninitialized members being referenced in the Halted state.
	  These changes depend on the same related tags as V04-00-00.

2008-10-14  Kurt Biery <biery@fnal.gov>

	* tag V04-00-00
	* Initial changes to support unique filter unit IDs.  Fixed a couple
	  of minor bugs in the FragmentCollector uncovered by running the
	  RunCollector_t unit test.  Updated the RunCollector_t unit test to
	  get it working again.  These changes depend on the following related tags:
	  EventFilter/Utilities      V00-15-00
	  EventFilter/ShmBuffer      V00-07-00
	  EventFilter/ShmReader      V01-03-00
	  EventFilter/ResourceBroker V00-11-00
	  IOPool/Streamer            V05-04-00
	  EventFilter/Modules        V00-06-00

2008-10-13  Harry Cheung <cheung@fnal.gov>

	* tag V03-14-19
	* Install performance statistics for stored data rates like for
	  received data rates. Changed the stored volume infospace variable
	  to actually give the stored volume and not the received data volume.

2008-10-12  Harry Cheung <cheung@fnal.gov>

	* tag V03-14-18
	* Changed SMPerformanceMeter to use Kurt's counter classes and also
	  introduce a rate over a time period as well as a rate over a
	  given number of samples. Both are now given and the samples and
	  time period can be set in the SM XML xdaq config file (see sm_onenode.xml)
	  Also getting  and reporting statistics for received event sizes 
	  using a new counter class, still need to get the compression ratio
	  and fragment queue size when statistics gathering is moved to 
	  the FragmentCollector

2008-10-09  Kurt Biery <biery@fnal.gov>

	* tag V03-14-17
	* Added rcmsStateListener parameters to the SM application infospace
	  as requested by Hannes to support large configurations in the online.
	  Also, modified the sequence of operations at end run to correctly
	  assign file and event count statistics. This tag requires
	  EventFilter/Utilities V00-14-16.

2008-09-23  Kurt Biery <biery@fnal.gov>

	* tag V03-14-16
	* Reduced the number of copies of INIT messages kept in memory.
	  This should eliminate the out-of-memory crashes that we have
	  observed when testing with large numbers of filter units and
	  a large HLT configuration. (Crashes were seen when the RBSender
	  web page was visited and when multiple runs were started without
	  intervening destroy/configure transitions.)

2008-09-20  Kurt Biery <biery@fnal.gov>

	* tag V03-14-15
	* Added protection against NULL registry data pointers in 
	  StorageManager::receiveRegistryMessage().  Added clearing of the
	  SMFUSenderList in the enabling() method of StorageManager.
	  These changes will hopefully reduce or eliminate the occasional
	  crashes of the SM at the beginning of runs.

2008-09-16  Kurt Biery <biery@fnal.gov>

	* tag V03-14-14
	* Modified the INIT message handling in SMFUSenderEntry to handle
	  multiple INIT messages from the same RB.  Re-enabled the RBSender
	  web page.  Added partial fixes for the storedEvents problem at 
	  end run.  Added support for gracefully handling duplicate event
	  numbers when running with multiple AutoBUs.

2008-09-04  Kurt Biery <biery@fnal.gov>

	* tag V03-14-12
	* Modified the file closing logic so that it periodically tests whether files
	  need to be closed independent of whether events are being received or not.

2008-09-03  Harry Cheung <cheung@fnal.gov>

	* tag V03-14-11
	* Put in Emilio's fix for his workloop code when in failed state
	* Change the value of the real default for the file closing timeout to 45s

2008-09-02  Harry Cheung <cheung@fnal.gov>

	* tag V03-14-10
	* Possible fix for problem seen with running more FU instances
	  by properly taking into account non-unique fuID, need proper
	  fix when moving INIT message to FragmentCollector

2008-09-01  Harry Cheung <cheung@fnal.gov>

	* tag V03-14-09
	* Temporary solution for stored events statistics, gathered in workloop instead
	  and also removed temporarily the RB senders web page link that was causing
	  problems until we can reproduce it in a test setup

2008-08-27  Kurt Biery <biery@fnal.gov>

	* tag V03-14-08
	* Added variable reinitialization to the ServiceManager::stop() method.
	  With this change and a fix to clear the contents of the InitMsgCollection
	  in StorageManager::enabling(), hopefully the SM will correctly handle
	  Stop/Enable transitions (with regard to output file handling).

2008-08-22  Kurt Biery <biery@fnal.gov>

	* tag V03-14-07
	* Fixed bug in looping over output files.

2008-08-22  Constantin Loizides <loizides@mit.edu>

	* tag V03-14-06
	* Rolled back the algorithm for closing files - it only depends on
	  a time interval with this change - there is no dependence on lumi
	  section number.

2008-08-18  Kurt Biery <biery@fnal.gov>

	* tag V03-14-03
	* Flashlist fixes: Uncommented fireItemAvailable of storedEvents in
	  StorageManager.cc for Constantin/Emilio. Updated forgotten conversion
	  of connectedFUs to connectedRBs in test/sm.flash.

2008-08-17  Harry Cheung <cheung@fnal.gov>

	* tag V03-14-02
	* Fix for handling large INIT message (multiple I2O frames).

2008-08-14  Constantin Loizides <loizides@mit.edu>

	* tag V03-14-01
	* Script changes.
	* Fix to lumi file closing and minor change to Error stream handling.

2008-08-13  Kurt Biery <biery@fnal.gov>

	* tag V03-14-00
	* Added the Error stream.  This included converting the StreamService and
	  OutputService classes into interfaces and creating derived classes for
	  handling regular events and FRDEvents (FED Raw Data Events) [which is a
	  more generic name for Error events].  This change depends on
	  IOPool/Streamer V05-02-00.

2008-08-13  William Tanenbaum <wmtan@fnal.gov>

	* tag V03-13-00
	* Bug fix for a repacker problem. Due to the data dictionaries being loaded
	  too late, the repacker writes the raw data fully split, rather than unsplit,
	  as was specified in the dictionary.  This is not a critcal problem in that
	  the number of extra branches due to the splitting is small.  Nonetheless,
	  this fix should be picked up in 2_1_X, although it is not critical for 2_1_3.

2008-08-13  Kurt Biery <biery@fnal.gov>

	* tag V03-12-16
	* Backed out recent RB Sender web page changes until we've had a chance
	  to test them more.
	* Modified the use of the XDAQ Chrono class in SMPerformanceMeter to help
	  avoid negative statistics on monitor web pages.

2008-08-07  Constantin Loizides <loizides@mit.edu>

	* tag V03-12-15
	* Fixes a flaw/bug in the way the lumi-section timeout is handled. 
	  Following the suggestion by Kurt the following is enforced:
	   1. The first flaw is that the LumiSectionTimeout is enforced against
	      the time that the last event arrived for LumiSection N instead of
	      the time of the arrival of the first event in LumiSection N+1.
	   2. The second flaw is that each stream keeps track of its own
	      starting point for the timeout rather than using a common value.
	  This is implemented by a modified version of
	  StreamService::closeTimedOutFiles() which is called by
	  ServiceManager::ManageEventMessage() for each stream.

2008-07-19  William Tanenbaum <wmtan@fnal.gov>

	* tag V03-12-14
	* Critical fix for Streamer.  The streamer has not been kept up to date with
	  changes in the format of metadata, so it was not saving all of the metadata,
	  in particular, the Parameterset registry, Module Description registry,
	  EventHistory registry, and EntryDescription registry.  With this change, the
	  first two are saved in the header, while the data from the latter two are saved
	  not as registries, but event by event.

2008-07-17  Harry Cheung <cheung@fnal.gov>

	* tag V03-12-13
	* Fixes from KB for scalar MEs (ints, floats, strings):  correctly determine ME
	  name; switched to using first instance when collating rather than last instance.

2008-07-03  Kurt Biery <biery@fnal.gov>

	* tag V03-12-12
	* Updated DQMHttpSource to take advantage of RawInputSource changes
	  (to correctly set the run and lumi numbers).
	* Removed unneeded TApplication attributed from DQMServiceManager.
	* Various (minor?) script changes from Constantin.

2008-06-25  Kurt Biery <biery@fnal.gov>

	* tag V03-12-11
	* Fixed bugs in DQM histogram serving and archiving.
	* Added archiveIntervalDQM configuration parameter to control how often
	  we archive DQM histograms (once every N lumi sections, where
	  archiveIntervalDQM = N).
	* Slightly modified format of DQM archive filenames.

2008-06-23 Constantin Loizides <loizides@mit.edu>

	* tag V03-12-10
	* Bugfix to handle large files (>2GB).

2008-06-16  Kurt Biery <biery@fnal.gov>

	* tag V03-12-09
	* Cleanup of the scripts subdirectories and modification of the scripts to
	  match what was run for Cruzet2 (full blown separate DB and new DB scheme 
          handling).  [from Constantin]
	* Modification of the EventServer to match what was run in
	  Cruzet2 (fair-share off, rates limited at the EventServer input, and 
	  events for consumers restricted to a single HLT output module).

2008-06-?? Constantin Loizides <loizides@mit.edu>

	* tag V03-12-08
	* 

2008-06-03  Harry Cheung <cheung@fnal.gov>

	* tag V03-12-07
	* Quick fix for registration problem with 2 rails (threads)

2008-06-03  Harry Cheung <cheung@fnal.gov>

	* tag V03-12-06
	* Fixes from Kurt for DQM ME receiving (still has wrong run and LS numbers though)

2008-05-15  Harry Cheung <cheung@fnal.gov>

	* tag V03-12-05
	* Fix to FUSender* classes to handle multiple HLT output modules

2008-05-14  Harry Cheung <cheung@fnal.gov>

	* tag V03-12-04
	* Kurt's changes to include event server statistics by HLT output module

2008-05-14 Constantin Loizides <loizides@mit.edu>

	* tag V03-12-03
	* Moved calls to scripts outside of the Storage manager and fixed web display of
	  running Workers (script jobs)

2008-05-12  Harry Cheung <cheung@fnal.gov>

	* tag V03-12-02
	* Include a callback function to handle error events from resource broker with separate
	  I2O function code. Gave it a new ERROR_EVENT message code that requires
	  IOPool/Streamer tag hwkc20080512 (V04-34-01), this stops problems on receiving error
	  events, but the error events are not yet written out!

2008-05-11  Harry Cheung <cheung@fnal.gov>

	* tag V03-12-01
	* Report storedEvents as actually stored events and not received events. Added reporting
	  of received events for each HLT output module, and stored events for each SM stream.

2008-05-05  Harry Cheung <cheung@fnal.gov>

	* tag V03-12-00
	* Changes from Kurt for SM selecting on HLT ouptut module ID and INIT message change
	  from Streamer protocol 5 to 6

2008-04-21  Constantin Loizides <loizides@mit.edu>

	* tag V03-11-01
	* Implemented transfer to t0 with independent daemon (daemon to be written seperately).
	* General cleanup of code

2008-04-17  Harry Cheung <cheung@fnal.gov>

	* tag V03-11-00
	* Include fair share event consumer handling in event server and consumer monitoring

2008-03-10  Harry Cheung <cheung@fnal.gov>

	* tag V03-10-02
	* Changes to throw exception when a write error is encountered

2008-03-10  Emilio Meschi <emilio.meschi@cern.ch>

	* tag V03-10-01 (was tagged V03-09-07 but in Main trunk so deleted)
	* modifications to override stream maxSize from xdaq

2008-03-04  Harry Cheung <cheung@fnal.gov>

	* tag V03-10-00
	* modifications for DQM core services needed in 20X

2008-03-03  Harry Cheung <cheung@fnal.gov>

	* tag V03-09-06 
	* Remove unused variable and printout from the thread monitoring workloop
	* Enable consumers to select an SM stream by the SM streamLabel

2008-02-25  Emilio Meschi <emilio.meschi@cern.ch>

	* tag V03-09-05 
	* added monitoring workloop and related functions
	* added E->F asynchronous transition when failure detected in JobController thread
	* added data structure to hold detailed stream file info 
	* stream info and run number added to web page
	* added findStreamName utility to extract stream name from entry in filelist
	* modified StreamService to use a mutex around access to file list
	* replaced application icons

2008-02-21  Harry Cheung <cheung@fnal.gov>

	* tag V03-09-04 
	* Fixes to allow propor behavior for file sizes greater than 2GB, and to
	  make the cfg file specify the max file size in MBytes instead of bytes.

2008-02-11  Harry Cheung <cheung@fnal.gov>

	* tag V03-09-03 
	* Support for SMProxyServer as a special consumer when we have multiple
	  HLT output modules.

2008-02-02  Harry Cheung <cheung@fnal.gov>

	* tag V03-09-02 
        * New version of SMPerformanceMeterfor thread safety so SMProxyServer can
          use this for both incoming and outgoing statistics when in pull mode
        * Modified StorageManager to use this new version and test XML config to
          set SMProxyServer parameters

2008-01-30  Harry Cheung <cheung@fnal.gov>

	* tag V03-09-00 Changes to handle multiple output modules in the HLT processes

2008-01-28  Harry Cheung <cheung@fnal.gov>

	* tag V03-08-03 (Don't know what changed in V03-08-02! Probably framework changes)
	* Fix bug in DQMConsumerPipe, and using priority=PushMode for pushmode
	* Set pushmode to false in example XML config files

2007-12-12  Harry Cheung <cheung@fnal.gov>

	* tag V03-08-01 (no entries made for previous tags! Lump all changes here))
	* Updated consumer queues with real queues and changed default size
        * Handle consumers asking for non-existent trigger names
        * Add a consumer web app page for monitoring
        * Updated for framework changes

2007-10-23  Harry Cheung <cheung@fnal.gov>

	* tag V03-07-10
	* Fix of DQMInstance.cc from Billbadgett for number of digits for run and
          lumi numbers, same convention as for event data files. Also to chmod to
          DQM output root files to make them world readable.

2007-10-18  Harry Cheung <cheung@fnal.gov>

	* tag V03-07-09
	* Fixed ConsumerPipe to avoid 2 sec/event delay in pushing events to the
          SMProxyServer, and also fix intermittent hang in pushing events when
          curl tries to reuse a dead connection

2007-10-14  Harry Cheung <cheung@fnal.gov>

	* tag V03-07-08
	* Fixed StorageManager to also test the DQM archive output base path
          if we have requested DQM archiving

2007-10-14  Harry Cheung <cheung@fnal.gov>

	* tag V03-07-07
	* Fixed bug in ConsumerPipe and DQMConsumerPipe where pushEvent to the
          SMSProxyServer did not update the "lastEventRequestTime_"

2007-10-08  Harry Cheung <cheung@fnal.gov>

	* tag V03-07-06
	* Changed EventStreamHttpReader to fix a print bug and give a warning
          for when the SM was halted rather than stopped.

2007-10-08  Harry Cheung <cheung@fnal.gov>

	* tag V03-07-05
	* Changed EventStreamHttpReader to allow reconnect if the SM is down 
          (Change from Bill).

2007-09-14  Harry Cheung <cheung@fnal.gov>

	* tag V03-07-04
	* fixed EventStreamHttpReader to allow proper end of run processing, 
          and add an example to check proper behaviour. Requires
          IOPool/Streamer V04-24-00 only in the 1_7_X series.

2007-09-12  Harry Cheung <cheung@fnal.gov>

	* tag V03-07-03
	* fixed SMDQMClientExample.cc to be compatible with changes to DQM Services
          by removing use of MonitorUIRoot/MonitorUserInterface

2007-08-22  Emilio Meschi <Emilio.Meschi@cern.ch>

	* tag V03-07-02
	* fixed icon paths in application web page

2007-08-19  Harry Cheung <cheung@fnal.gov>

	* tag V03-07-01
        * Check that output base path, mailbox path, and perl script files 
          actually exist during configure action, go into fail state if
          any of these do not exist.

2007-08-18  Harry Cheung <cheung@fnal.gov>

	* tag V03-07-00
        * changes to move parameters out of streamer output modules and
          allow default values. So online parameters are in the SM XDAQ XML file
          while offline parameters have defaults and can be missing from the
          config file. The parameters common to all streams appear in the XML
          file, while each specific stay in the SM config file.
        * Change to allow the Storage Manager main thread to see the status of
          the FragmentCollector thread, and print out error messages for problems.
          Can later do cleanup and change to a fail state is desired.

2007-08-16  Harry Cheung <cheung@fnal.gov>

	* tag V03-06-00
        * changes to enter a failed state on problem with an action and
          reporting the state and reason for failure in application web page

2007-06-30  Harry Cheung <cheung@fnal.gov>

	* tag V03-04-08
        * changes for xdaq3.9

2007-06-28  Harry Cheung <cheung@fnal.gov>

	* tag V03-04-07
        * changes to scripts for communication with Tier-0 (Markus)
        * changes to cfg files in test for LNF support change in IOPool/Streamer

2007-06-19  Harry Cheung <cheung@fnal.gov>

	* tag V03-04-06
        * remove xdaq3.9 changes from the head so we can submit changes to nightly

2007-06-13  Harry Cheung <cheung@fnal.gov>

	* tag V03-04-05
        * fixes to DQM collation and archiving from Bill Badgett
	* changes to scripts arguments for communication with Tier-0 from Markus
        * fix for using DQMHttpSource with a FUEP app running EP in async

